<div class="search" [formGroup]="searchFormGroup">
  <div class="w-100 pr-3">
    <div class="d-flex">
      <div class="col-4 pl-0">
        <label>{{ 'quote.search.label.author' | translate }}</label>
        <app-input-dropdown [control]="this.searchFormGroup.get('author')"
                            [items]="authors"
                            [clean]="[onFilter, onFilterReset]"
                            (onItemSelection)="this.authorId = $event.id"
                            (onItemUnselection)="this.authorId = null">
        </app-input-dropdown>
      </div>
      <div class="col-4">
        <label>{{ 'quote.search.label.book' | translate }}</label>
        <app-input-dropdown [control]="this.searchFormGroup.get('book')"
                            [items]="books"
                            [clean]="[onFilter, onFilterReset]"
                            (onItemSelection)="this.bookId = $event.id"
                            (onItemUnselection)="this.bookId = null">
        </app-input-dropdown>
      </div>
      <div class="col-4">
        <label>{{ 'quote.search.label.category' | translate }}</label>
        <app-input-dropdown [control]="this.searchFormGroup.get('category')"
                            [items]="categories"
                            [isMultiselect]="true"
                            [isReadonly]="true"
                            [clean]="[onFilter, onFilterReset]"
                            (onItemSelection)="onCategorySelection($event)"
                            (onItemUnselection)="onCategoryUnselection($event)">
        </app-input-dropdown>
      </div>
    </div>
    <ng-container *ngIf="mode === SearchMode.quoteMode">
      <div class="col-12 mt-2 pl-0">
        <label>{{ 'quote.search.label.text' | translate }}</label>
        <input class="form-control"
               formControlName="text">
      </div>
      <div class="col-12 mt-2 pl-0">
        <label>{{ 'quote.search.label.tags' | translate }}</label>
        <app-input-dropdown [control]="this.searchFormGroup.get('tags')"
                            [items]="tags"
                            [isMultiselect]="true"
                            [showSelectedItemsSeparately]="true"
                            [isFirstCharacterSpecial]="true"
                            [clean]="[onFilter, onFilterReset]"
                            (onItemSelection)="onTagSelection($event)"
                            (onItemUnselection)="onTagUnselection($event)">
        </app-input-dropdown>
      </div>
    </ng-container>
    <ng-container *ngIf="mode === SearchMode.bookMode">
      <div class="col-12 added-by-user">
        <input class="form-check-input"
               type="checkbox"
               (change)="onShowOnlyAddedByUserChange()">
        <label>{{ 'quote.search.label.addedByUser' | translate }}</label>
      </div>
    </ng-container>
  </div>
  <div class="d-flex flex-column justify-content-center">
    <button *ngIf="canReset" class="btn btn-secondary p-2 mb-3"
            (click)="reset()">
      <span class="material-symbols-outlined bold">restart_alt</span>
    </button>
    <button class="btn btn-primary p-2"
            [disabled]="!canBeFiltered"
            (click)="find()">
      <span class="material-symbols-outlined bold">search</span>
    </button>
  </div>
</div>

<ngx-loading [show]="isLoading"></ngx-loading>
